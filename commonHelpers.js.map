{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nexport let per_page = 15;\n\nexport async function fetchPhotos(query, currentPage) {\n  const API_KEY = '42557363-2349d8dc8525cd1cea516a01b';\n  const BASE_URL = 'https://pixabay.com/api/';\n  const END_POINT = '';\n  const url = `${BASE_URL}${END_POINT}`;\n  const params = {\n    key: API_KEY,\n    q: query,\n    orientation: 'horizontal',\n    per_page: per_page,\n    page: currentPage,\n    safesearch: true,\n  };\n  const res = await axios.get(url, { params });\n  return res.data;\n}","function photoTemplate(item) {\n  const { pageURL, previewURL, webformatURL, tags, likes, views, comments, downloads } = item;\n  return `\n\n  <li class=\"gallery-item\">\n  <a href=\"${item.webformatURL}\" class=\"image-link\">\n      <img class=\"gallery-image\" src=\"${item.webformatURL}\" alt=\"${item.tags}\">\n  </a>\n  <div class=\"comments\">\n      <div class=\"desc\">\n          <p class=\"label\">Likes</p>\n          <p class=\"value\">${item.likes}</p>\n      </div>\n      <div class=\"desc\">\n          <p class=\"label\">Views</p>\n          <p class=\"value\">${item.views}</p>\n      </div>\n      <div class=\"desc\">\n          <p class=\"label\">Comments</p>\n          <p class=\"value\">${item.comments}</p>\n      </div>\n      <div class=\"desc\">\n          <p class=\"label\">Downloads</p>\n          <p class=\"value\">${item.downloads}</p>\n      </div>\n  </div>\n</li>\n\n`;\n}\nexport function photosTemplate(articles) {\n  return articles.map(photoTemplate).join('');\n}\n\n\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchPhotos } from './js/pixabay-api.js';\nimport { photosTemplate } from './js/render-functions.js';\nimport { per_page } from './js/pixabay-api.js';\n\n// SimpleLightbox params\nconst options = {\n  captions: true,\n  captionSelector: 'img',\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  animation: 250,\n  widthRatio: 0.9,\n  scaleImageToRatio: true,\n};\n\nconst lightbox = new SimpleLightbox('.gallery a', options);\n\nconst refs = {\n  formElem: document.querySelector('.js-search-form'),\n  photoListElem: document.querySelector('.js-photo-list'),\n  btnLoadMore: document.querySelector('.js-btn-load'),\n  loadElem: document.querySelector('.js-loader'),\n};\n\nlet query;\nlet page;\nlet maxPage;\n\nrefs.formElem.addEventListener('submit', onFormSubmit);\nrefs.btnLoadMore.addEventListener('click', onLoadMoreClick);\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  query = e.target.elements.query.value.trim();\n  page = 1;\n  if (!query) {\n    showError('Empty field');\n    return;\n  }\n  showLoader();\n  try {\n    const data = await fetchPhotos(query, page);\n    if (data.totalHits === 0) {\n      showError('Нічого не знайдено!');\n    }\n    maxPage = Math.ceil(data.totalHits / per_page);\n    console.log(\"data.totalHits:\", data.totalHits);\n\n    refs.photoListElem.innerHTML = '';\n    renderPhotos(data.hits);\n    lightbox.refresh(); \n\n  } catch (err) {\n    showError(err);\n  }\n\n  hideLoader();\n  checkBtnVisibleStatus();\n  e.target.reset();\n}\n\nasync function onLoadMoreClick() {\n  page += 1;\n  // console.log(page, \"/\", maxPage);\n  \n  showLoader();\n  const data = await fetchPhotos(query, page);\n  renderPhotos(data.hits);\n  lightbox.refresh();\n  hideLoader();\n  checkBtnVisibleStatus();\n  const height = refs.photoListElem.firstElementChild.getBoundingClientRect().height; // высота\n  scrollBy({\n    behavior: 'smooth',\n    top: (height*3.5), // прокрутка на 3,5 высоты\n  });\n}\nfunction renderPhotos(photos) {\n  const markup = photosTemplate(photos);\n  refs.photoListElem.insertAdjacentHTML('beforeend', markup);\n\n}\nfunction showLoadBtn() {\n  refs.btnLoadMore.classList.remove('hidden');\n}\nfunction hideLoadBtn() {\n  refs.btnLoadMore.classList.add('hidden');\n}\nfunction showLoader() {\n  refs.loadElem.classList.remove('hidden');\n}\nfunction hideLoader() {\n  refs.loadElem.classList.add('hidden');\n}\n\nfunction showError(msg) {\n  iziToast.error({\n    title: 'Error',\n    message: msg,\n  });\n}\n\nfunction checkBtnVisibleStatus() {\n  if ((page >= maxPage)) {\n\n    hideLoadBtn();\n    if (page > 1) { showError(\"We're sorry, but you've reached the end of search results.\"); }\n  } else {\n    showLoadBtn();\n  }\n}\n"],"names":["per_page","fetchPhotos","query","currentPage","API_KEY","url","params","axios","photoTemplate","item","photosTemplate","articles","options","lightbox","SimpleLightbox","refs","page","maxPage","onFormSubmit","onLoadMoreClick","showError","showLoader","data","renderPhotos","err","hideLoader","checkBtnVisibleStatus","height","photos","markup","showLoadBtn","hideLoadBtn","msg","iziToast"],"mappings":"owBACO,IAAIA,EAAW,GAEf,eAAeC,EAAYC,EAAOC,EAAa,CACpD,MAAMC,EAAU,qCAGVC,EAAM,2BACNC,EAAS,CACb,IAAKF,EACL,EAAGF,EACH,YAAa,aACb,SAAUF,EACV,KAAMG,EACN,WAAY,EAChB,EAEE,OADY,MAAMI,EAAM,IAAIF,EAAK,CAAE,OAAAC,CAAM,CAAE,GAChC,IACb,CClBA,SAASE,EAAcC,EAAM,CAE3B,MAAO;AAAA;AAAA;AAAA,aAGIA,EAAK,YAAY;AAAA,wCACUA,EAAK,YAAY,UAAUA,EAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,6BAK/CA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA,6BAIVA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA,6BAIVA,EAAK,QAAQ;AAAA;AAAA;AAAA;AAAA,6BAIbA,EAAK,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA,CAM3C,CACO,SAASC,EAAeC,EAAU,CACvC,OAAOA,EAAS,IAAIH,CAAa,EAAE,KAAK,EAAE,CAC5C,CCrBA,MAAMI,EAAU,CACd,SAAU,GACV,gBAAiB,MACjB,YAAa,OACb,aAAc,MACd,gBAAiB,SACjB,UAAW,IACX,WAAY,GACZ,kBAAmB,EACrB,EAEMC,EAAW,IAAIC,EAAe,aAAcF,CAAO,EAEnDG,EAAO,CACX,SAAU,SAAS,cAAc,iBAAiB,EAClD,cAAe,SAAS,cAAc,gBAAgB,EACtD,YAAa,SAAS,cAAc,cAAc,EAClD,SAAU,SAAS,cAAc,YAAY,CAC/C,EAEA,IAAIb,EACAc,EACAC,EAEJF,EAAK,SAAS,iBAAiB,SAAUG,CAAY,EACrDH,EAAK,YAAY,iBAAiB,QAASI,CAAe,EAE1D,eAAeD,EAAa,EAAG,CAI7B,GAHA,EAAE,eAAc,EAChBhB,EAAQ,EAAE,OAAO,SAAS,MAAM,MAAM,OACtCc,EAAO,EACH,CAACd,EAAO,CACVkB,EAAU,aAAa,EACvB,MACD,CACDC,IACA,GAAI,CACF,MAAMC,EAAO,MAAMrB,EAAYC,EAAOc,CAAI,EACtCM,EAAK,YAAc,GACrBF,EAAU,qBAAqB,EAEjCH,EAAU,KAAK,KAAKK,EAAK,UAAYtB,CAAQ,EAC7C,QAAQ,IAAI,kBAAmBsB,EAAK,SAAS,EAE7CP,EAAK,cAAc,UAAY,GAC/BQ,EAAaD,EAAK,IAAI,EACtBT,EAAS,QAAO,CAEjB,OAAQW,EAAK,CACZJ,EAAUI,CAAG,CACd,CAEDC,IACAC,IACA,EAAE,OAAO,OACX,CAEA,eAAeP,GAAkB,CAC/BH,GAAQ,EAGRK,IACA,MAAMC,EAAO,MAAMrB,EAAYC,EAAOc,CAAI,EAC1CO,EAAaD,EAAK,IAAI,EACtBT,EAAS,QAAO,EAChBY,IACAC,IACA,MAAMC,EAASZ,EAAK,cAAc,kBAAkB,sBAAuB,EAAC,OAC5E,SAAS,CACP,SAAU,SACV,IAAMY,EAAO,GACjB,CAAG,CACH,CACA,SAASJ,EAAaK,EAAQ,CAC5B,MAAMC,EAASnB,EAAekB,CAAM,EACpCb,EAAK,cAAc,mBAAmB,YAAac,CAAM,CAE3D,CACA,SAASC,GAAc,CACrBf,EAAK,YAAY,UAAU,OAAO,QAAQ,CAC5C,CACA,SAASgB,GAAc,CACrBhB,EAAK,YAAY,UAAU,IAAI,QAAQ,CACzC,CACA,SAASM,GAAa,CACpBN,EAAK,SAAS,UAAU,OAAO,QAAQ,CACzC,CACA,SAASU,GAAa,CACpBV,EAAK,SAAS,UAAU,IAAI,QAAQ,CACtC,CAEA,SAASK,EAAUY,EAAK,CACtBC,EAAS,MAAM,CACb,MAAO,QACP,QAASD,CACb,CAAG,CACH,CAEA,SAASN,GAAwB,CAC1BV,GAAQC,GAEXc,IACIf,EAAO,GAAKI,EAAU,4DAA4D,GAEtFU,GAEJ"}